{
  "actions" : {
    "build" : {
      "enabled" : true,
      "script" : "#!\/bin\/zsh\n# Set red for echo output\nRED='\\033[0;31m'\n\ncd website\n\nhtml_destroyer() {\n#alternative plus simple \n#find _site\/ -type f ! -iname 'index.html' -iname '*.html' -print0 | while read -d $'\\0' f; do mv \"$f\" \"${f%.html}\"; done\nfor filename in $target_folder\/*.html; do\n\tif [ $filename != \"_site\/index.html\" ];\n\tthen\n\tif [ $filename != \"_site\/main.html\" ];\n\tthen\n\t\toriginal=\"$filename\"\n\t\t# Get the filename without the path\/extension\n\t\tfilename=$(basename \"$filename\")\n\t\textension=\"${filename##*.}\"\n\t\tfilename=\"${filename%.*}\"\n\n\t\t# Move it\n\t\tmv $original $target_folder\/$filename\n\tfi\n\tfi\ndone\n}\n\n# Make resized social media card images\nfind \"assets\" -type f -name '*-start.png' -print0 | while IFS= read -r -d '' line; do\n  filename=\"${line%.*}\"\n  finalname=\"${filename}-social-share-card.png\"\n  if [ ! -f \"${finalname}\" ]; then\n\techo \"${RED}Card image for \"${line}\" does not exist.\"\n\tcp \"${line}\" \"${finalname}\"\n\tmagick mogrify -interpolate nearest -filter point -resize 437.5% \"$finalname\"\n\tmagick mogrify -bordercolor black -border 250x0 \"$finalname\"\n\techo \"${RED}Card image \"${finalname}\" done.\"\n  fi\ndone\necho \"${RED}Card images checked.\"\n\n# Batir le site\nJEKYLL_ENV=production bundle exec jekyll build\n\ntarget_folder=\"_site\"\necho \"${RED}Removing html extensions in $target_folder.\"\nhtml_destroyer\ntarget_folder=\"_site\/timelines\"\necho \"${RED}Removing html extensions in $target_folder.\"\nhtml_destroyer\ntarget_folder=\"_site\/articles\"\necho \"${RED}Removing html extensions in $target_folder.\"\nhtml_destroyer\n\n# Trouver et enlever les fichiers de macOS\nfind \"_site\" -type f -name '.DS_store' -delete\necho \"${RED}.DS_store in _site removed.\""
    },
    "run" : {
      "enabled" : true,
      "script" : "#!\/bin\/zsh\nRED='\\033[0;31m'\necho \"${RED}Invalidating CloudFront distribution.\"\naws cloudfront create-invalidation \\\n  --distribution-id E2D1OXPUZ47PTX \\\n  --paths \"\/*\""
    }
  },
  "openLogOnRun" : "start"
}
